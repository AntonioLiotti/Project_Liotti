# Funzione per validare la data
def valida_data(data):
    try:
        giorno, mese, anno = map(int, data.split('/'))
        assert 1 <= giorno <= 31 and 1 <= mese <= 12 and len(str(anno)) == 4
        return True
    except (ValueError, AssertionError):
        return False

# Funzione principale
def crea_fattura():
    # Input dati fattura
    numero_fatture = input("Inserisci il numero della fattura:")

    data_emissione = input("Inserisci data della fattura (formato GG/MM/AAAA):")
    while not valida_data(data_emissione):
        print("Data non valida, riprova.")
        data_emissione = input("Inserisci data della fattura (formato GG/MM/AAAA):")

    nome_cliente = input("Inserisci il nome del cliente:")

    # Validazione dell'importo fattura
    try:
        totale_fattura = float(input("Inserisci importo della fattura senza IVA:"))
    except ValueError:
        print("Importo non valido. Inserisci un numero.")
        return

    # Calcolo IVA e totale
    iva = totale_fattura * 0.22
    totale_fattura_iva = totale_fattura + iva

    # Salva i dati della fattura in modo ordinato
    with open("fatture.txt", "a") as fileFatture:
        fileFatture.write(f"Numero Fattura: {numero_fatture}\n")
        fileFatture.write(f"Data Emissione: {data_emissione}\n")
        fileFatture.write(f"Nome Cliente: {nome_cliente}\n")
        fileFatture.write(f"Totale Fattura (senza IVA): {totale_fattura:.2f} €\n")
        fileFatture.write(f"IVA (22%): {iva:.2f} €\n")
        fileFatture.write(f"Totale Fattura (con IVA): {totale_fattura_iva:.2f} €\n")
        fileFatture.write("-" * 40 + "\n")  # Linea separatrice per ogni fattura

    print("Fattura salvata con successo!")

# Chiamata alla funzione
crea_fattura()
